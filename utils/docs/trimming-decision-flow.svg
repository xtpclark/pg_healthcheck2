<svg contentStyleType='text/css' data-diagram-type='ACTIVITY' height='1774px' preserveAspectRatio='none' style='width:1164px;height:1774px;background:#FFFFFF;' version='1.1' viewBox='0 0 1164 1774' width='1164px' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg' zoomAndPan='magnify'><title>Trimming Decision Process - PostgreSQL Example</title><defs/><g><text fill='#000000' font-family='sans-serif' font-size='14' font-weight='bold' lengthAdjust='spacing' textLength='344.7103' x='408.29' y='34.9659'>Trimming Decision Process - PostgreSQL Example</text><ellipse cx='422.7642' cy='60.0679' fill='#222222' rx='10' ry='10' style='stroke:#222222;stroke-width:1;'/><path d='M530.0987,80.0679 L530.0987,134.186 L510.0987,138.186 L530.0987,142.186 L530.0987,196.304 A0,0 0 0 0 530.0987,196.304 L677.4979,196.304 A0,0 0 0 0 677.4979,196.304 L677.4979,90.0679 L667.4979,80.0679 L530.0987,80.0679 A0,0 0 0 0 530.0987,80.0679' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M667.4979,80.0679 L667.4979,90.0679 L677.4979,90.0679 L667.4979,80.0679' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='112.0601' x='536.0987' y='98.9649'>Example modules:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='110.1101' x='536.0987' y='116.6709'>- vacuum_analysis</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='116.9611' x='536.0987' y='134.377'>- replication_health</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='121.7191' x='536.0987' y='152.083'>- postgres_overview</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='126.3991' x='536.0987' y='169.789'>- connection_metrics</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='78.8711' x='536.0987' y='187.495'>- table_count</text><rect fill='#F1F1F1' height='36.3441' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='174.6691' x='335.4296' y='120.0139'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='154.6691' x='345.4296' y='142.842'>Load all structured findings</text><path d='M538.9068,210.4082 L538.9068,246.8202 L518.9068,250.8202 L538.9068,254.8202 L538.9068,291.2322 A0,0 0 0 0 538.9068,291.2322 L791.0846,291.2322 A0,0 0 0 0 791.0846,291.2322 L791.0846,220.4082 L781.0846,210.4082 L538.9068,210.4082 A0,0 0 0 0 538.9068,210.4082' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M781.0846,210.4082 L781.0846,220.4082 L791.0846,220.4082 L781.0846,210.4082' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='216.0068' x='544.9068' y='229.3052'>vacuum_analysis &#8594; 1 critical, 2 high</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='165.2807' x='544.9068' y='247.0112'>replication_health &#8594; 1 high</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='231.1778' x='544.9068' y='264.7172'>missing_index_opportunities &#8594; 3 high</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='116.1407' x='544.9068' y='282.4232'>Others &#8594; no issues</text><rect fill='#F1F1F1' height='69.0323' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='192.2852' x='326.6216' y='216.304'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='172.2852' x='336.6216' y='239.1321'>Evaluate rules against findings</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='107.2808' x='336.6216' y='255.4762'>Populate issue lists</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='129.1089' x='336.6216' y='271.8203'>(critical, high, medium)</text><path d='M520.3607,301.2322 L520.3607,408.4683 L500.3607,412.4683 L520.3607,416.4683 L520.3607,523.7044 A0,0 0 0 0 520.3607,523.7044 L745.8249,523.7044 A0,0 0 0 0 745.8249,523.7044 L745.8249,311.2322 L735.8249,301.2322 L520.3607,301.2322 A0,0 0 0 0 520.3607,301.2322' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M735.8249,301.2322 L735.8249,311.2322 L745.8249,311.2322 L735.8249,301.2322' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='102.1801' x='526.3607' y='320.1292'>Priority Formula:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='87.0611' x='526.3607' y='337.8353'>base_weight +</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='124.4751' x='526.3607' y='355.5413'>(1000 if critical &gt; 0) +</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='93.7431' x='526.3607' y='373.2473'>(100 if high &gt; 0)</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='3.38' x='526.3607' y='390.9533'>&#160;</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='47.4371' x='526.3607' y='408.6593'>Results:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='139.1521' x='526.3607' y='426.3653'>vacuum_analysis: 1108</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='138.5671' x='526.3607' y='444.0713'>replication_health: 108</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='204.4642' x='526.3607' y='461.7774'>missing_index_opportunities: 105</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='135.8891' x='526.3607' y='479.4834'>postgres_overview: 10</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='133.1331' x='526.3607' y='497.1894'>connection_metrics: 7</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='139.9581' x='526.3607' y='514.8954'>table_count: 1 (default)</text><rect fill='#F1F1F1' height='52.6882' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='155.193' x='345.1677' y='386.1242'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='135.193' x='355.1677' y='408.9523'>Calculate priority scores</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='84.3966' x='355.1677' y='425.2964'>for all modules</text><rect fill='#F1F1F1' height='52.6882' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='156.081' x='344.7237' y='543.7044'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='136.081' x='354.7237' y='566.5325'>Sort modules by priority</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='72.3125' x='354.7237' y='582.8766'>(descending)</text><rect fill='#F1F1F1' height='90.8244' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='165.429' x='340.0497' y='616.3926'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='91.1166' x='350.0497' y='639.2207'>Initialize budget</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='108.1207' x='350.0497' y='655.5649'>max_tokens = 8000</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='145.429' x='350.0497' y='671.909'>budget = (8000 x 4) - 4000</text><text fill='#000000' font-family='sans-serif' font-size='16' font-weight='bold' lengthAdjust='spacing' textLength='141.0883' x='350.0497' y='692.529'>28,000 characters</text><rect fill='none' height='787.2078' style='stroke:#000000;stroke-width:1.5;' width='1142.2902' x='11' y='717.217'/><path d='M326.1288,717.217 L326.1288,729.285 L316.1288,739.285 L11,739.285' fill='none' style='stroke:#000000;stroke-width:1.5;'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='305.1288' x='14' y='733.183'>Single Loop: Process Modules in Priority Order</text><rect fill='#F1F1F1' height='69.0323' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='168.4771' x='338.5257' y='756.285'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='88.1526' x='348.5257' y='779.113'>current_size = 0</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='137.413' x='348.5257' y='795.4572'>findings_for_prompt = {}</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='148.4771' x='348.5257' y='811.8013'>trimmed_modules_log = {}</text><path d='M499.8045,906.2143 L499.8045,924.9203 L479.8045,928.9203 L499.8045,932.9203 L499.8045,951.6263 A0,0 0 0 0 499.8045,951.6263 L712.2817,951.6263 A0,0 0 0 0 712.2817,951.6263 L712.2817,916.2143 L702.2817,906.2143 L499.8045,906.2143 A0,0 0 0 0 499.8045,906.2143' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M702.2817,906.2143 L702.2817,916.2143 L712.2817,916.2143 L702.2817,906.2143' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='85.2411' x='505.8045' y='925.1113'>First iteration:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='191.4772' x='505.8045' y='942.8173'>vacuum_analysis (priority 1108)</text><rect fill='#F1F1F1' height='52.6882' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='114.0807' x='365.7239' y='902.5762'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='94.0807' x='375.7239' y='925.4043'>Get next module</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='86.5207' x='375.7239' y='941.7484'>from sorted list</text><rect fill='#F1F1F1' height='36.3441' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='211.7973' x='316.8655' y='975.2644'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='191.7973' x='326.8655' y='998.0925'>module_data = deepcopy(original)</text><rect fill='#F1F1F1' height='36.3441' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='273.9218' x='285.8033' y='1031.6085'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='253.9218' x='295.8033' y='1054.4366'>original_size = len(json.dumps(module_data))</text><polygon fill='#F1F1F1' points='353.6022,1087.9527,491.9262,1087.9527,503.9262,1102.9346,491.9262,1117.9164,353.6022,1117.9164,341.6022,1102.9346,353.6022,1087.9527' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='138.324' x='353.6022' y='1099.7116'>current_size + original_size</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='91.8713' x='353.6022' y='1114.6935'>&lt;= token_budget?</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='17.0829' x='324.5193' y='1099.7116'>yes</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='64.7125' x='503.9262' y='1099.7116'>no - won't fit</text><path d='M236.4491,1139.7266 L236.4491,1158.4326 L216.4491,1162.4326 L236.4491,1166.4326 L236.4491,1185.1386 A0,0 0 0 0 236.4491,1185.1386 L439.4623,1185.1386 A0,0 0 0 0 439.4623,1185.1386 L439.4623,1149.7266 L429.4623,1139.7266 L236.4491,1139.7266 A0,0 0 0 0 236.4491,1139.7266' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M429.4623,1139.7266 L429.4623,1149.7266 L439.4623,1149.7266 L429.4623,1139.7266' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='182.0132' x='242.4491' y='1158.6236'>Best case: Module fits entirely</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='75.4521' x='242.4491' y='1176.3296'>No data loss</text><rect fill='#D5E8D4' height='69.0323' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='175.4491' x='41' y='1127.9164'/><text fill='#000000' font-family='sans-serif' font-size='12' font-weight='bold' lengthAdjust='spacing' textLength='86.0856' x='51' y='1150.7445'>INCLUDE FULL</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='155.4491' x='51' y='1167.0886'>Add to findings_for_prompt</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='112.6688' x='51' y='1183.4328'>Update current_size</text><path d='M814.7903,1127.9164 L814.7903,1164.3285 L794.7903,1168.3285 L814.7903,1172.3285 L814.7903,1208.7405 A0,0 0 0 0 814.7903,1208.7405 L1004.5565,1208.7405 A0,0 0 0 0 1004.5565,1208.7405 L1004.5565,1137.9164 L994.5565,1127.9164 L814.7903,1127.9164 A0,0 0 0 0 814.7903,1127.9164' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M994.5565,1127.9164 L994.5565,1137.9164 L1004.5565,1137.9164 L994.5565,1127.9164' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='55.718' x='820.7903' y='1146.8135'>Example:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='168.7662' x='820.7903' y='1164.5195'>data: [item1, item2, item50]</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='55.146' x='820.7903' y='1182.2255'>becomes</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='77.6621' x='820.7903' y='1199.9315'>data: [item1]</text><rect fill='#F1F1F1' height='52.6882' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='155.973' x='638.8173' y='1141.9844'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='101.8687' x='648.8173' y='1164.8124'>Attempt trimming</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='135.973' x='648.8173' y='1181.1566'>Reduce all lists to 1 item</text><rect fill='#F1F1F1' height='36.3441' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='279.8618' x='576.8729' y='1228.7405'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='259.8618' x='586.8729' y='1251.5686'>trimmed_size = len(json.dumps(module_data))</text><polygon fill='#F1F1F1' points='644.9193,1285.0846,788.6883,1285.0846,800.6883,1300.0665,788.6883,1315.0484,644.9193,1315.0484,632.9193,1300.0665,644.9193,1285.0846' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='143.769' x='644.9193' y='1296.8435'>current_size + trimmed_size</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='91.8713' x='644.9193' y='1311.8254'>&lt;= token_budget?</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='17.0829' x='615.8365' y='1296.8435'>yes</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='89.9904' x='800.6883' y='1296.8435'>no - still too large</text><path d='M664.9114,1336.1776 L664.9114,1363.7366 L644.9114,1367.7366 L664.9114,1371.7366 L664.9114,1399.2956 A0,0 0 0 0 664.9114,1399.2956 L804.9395,1399.2956 A0,0 0 0 0 804.9395,1399.2956 L804.9395,1346.1776 L794.9395,1336.1776 L664.9114,1336.1776 A0,0 0 0 0 664.9114,1336.1776' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M794.9395,1336.1776 L794.9395,1346.1776 L804.9395,1346.1776 L794.9395,1336.1776' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='97.0971' x='670.9114' y='1355.0746'>Partial inclusion</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='119.0281' x='670.9114' y='1372.7806'>Preserves structure</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='71.8641' x='670.9114' y='1390.4866'>Loses detail</text><rect fill='#FFFFAA' height='85.3765' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='175.4491' x='469.4623' y='1325.0484'/><text fill='#000000' font-family='sans-serif' font-size='12' font-weight='bold' lengthAdjust='spacing' textLength='115.0388' x='479.4623' y='1347.8765'>INCLUDE TRIMMED</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='155.4491' x='479.4623' y='1364.2206'>Add to findings_for_prompt</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='112.6688' x='479.4623' y='1380.5647'>Update current_size</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='114.4808' x='479.4623' y='1396.9088'>Log trimming action</text><path d='M947.9021,1328.0055 L947.9021,1355.5646 L927.9021,1359.5646 L947.9021,1363.5646 L947.9021,1391.1236 A0,0 0 0 0 947.9021,1391.1236 L1123.2902,1391.1236 A0,0 0 0 0 1123.2902,1391.1236 L1123.2902,1338.0055 L1113.2902,1328.0055 L947.9021,1328.0055 A0,0 0 0 0 947.9021,1328.0055' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M1113.2902,1328.0055 L1113.2902,1338.0055 L1123.2902,1338.0055 L1113.2902,1328.0055' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='154.3881' x='953.9021' y='1346.9026'>Module excluded entirely</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='141.9471' x='953.9021' y='1364.6086'>Lower priority modules</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='152.9321' x='953.9021' y='1382.3146'>more likely to be skipped</text><rect fill='#F8CECC' height='69.0323' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='102.9626' x='824.9395' y='1325.0484'/><text fill='#000000' font-family='sans-serif' font-size='12' font-weight='bold' lengthAdjust='spacing' textLength='82.9626' x='834.9395' y='1347.8765'>SKIP MODULE</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='62.7604' x='834.9395' y='1364.2206'>Do not add</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='73.7045' x='834.9395' y='1380.5647'>Move to next</text><polygon fill='#F1F1F1' points='716.8038,1416.4249,728.8038,1428.4249,716.8038,1440.4249,704.8038,1428.4249,716.8038,1416.4249' style='stroke:#181818;stroke-width:0.5;'/><polygon fill='#F1F1F1' points='422.7642,1446.4249,434.7642,1458.4249,422.7642,1470.4249,410.7642,1458.4249,422.7642,1446.4249' style='stroke:#181818;stroke-width:0.5;'/><polygon fill='#F1F1F1' points='358.7887,845.3173,486.7397,845.3173,498.7397,857.3173,486.7397,869.3173,358.7887,869.3173,346.7887,857.3173,358.7887,845.3173' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='17.0829' x='426.7642' y='881.0762'>yes</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='127.9511' x='358.7887' y='861.5853'>More modules in queue?</text><text fill='#000000' font-family='sans-serif' font-size='11' lengthAdjust='spacing' textLength='13.4529' x='333.3358' y='854.0943'>no</text><rect fill='#F1F1F1' height='52.6882' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='145.7129' x='349.9077' y='1524.4249'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='125.7129' x='359.9077' y='1547.2529'>Generate final prompt</text><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='118.4048' x='359.9077' y='1563.5971'>using Jinja2 template</text><path d='M528.4307,1587.1131 L528.4307,1650.0841 L508.4307,1654.0841 L528.4307,1658.0841 L528.4307,1721.0552 A0,0 0 0 0 528.4307,1721.0552 L776.671,1721.0552 A0,0 0 0 0 776.671,1721.0552 L776.671,1597.1131 L766.671,1587.1131 L528.4307,1587.1131 A0,0 0 0 0 528.4307,1587.1131' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M766.671,1587.1131 L766.671,1597.1131 L776.671,1597.1131 L766.671,1587.1131' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='55.1071' x='534.4307' y='1606.0101'>Includes:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='155.5452' x='534.4307' y='1623.7161'>- Rendered prompt string</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='227.2402' x='534.4307' y='1641.4221'>- findings_for_prompt (trimmed data)</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='111.6441' x='534.4307' y='1659.1281'>- critical_issues list</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='149.5652' x='534.4307' y='1676.8342'>- high_priority_issues list</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='173.1732' x='534.4307' y='1694.5402'>- medium_priority_issues list</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='139.8021' x='534.4307' y='1712.2462'>- rule_application_stats</text><rect fill='#F1F1F1' height='36.3441' rx='12.5' ry='12.5' style='stroke:#181818;stroke-width:0.5;' width='171.3331' x='337.0977' y='1635.9121'/><text fill='#000000' font-family='sans-serif' font-size='12' lengthAdjust='spacing' textLength='151.3331' x='347.0977' y='1658.7402'>Return prompt + metadata</text><ellipse cx='422.7642' cy='1752.0552' fill='none' rx='11' ry='11' style='stroke:#222222;stroke-width:1;'/><ellipse cx='422.7642' cy='1752.0552' fill='#222222' rx='6' ry='6' style='stroke:#222222;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='70.0679' y2='120.0139'/><polygon fill='#181818' points='418.7642,110.0139,422.7642,120.0139,426.7642,110.0139,422.7642,114.0139' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='156.358' y2='216.304'/><polygon fill='#181818' points='418.7642,206.304,422.7642,216.304,426.7642,206.304,422.7642,210.304' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='285.3364' y2='386.1242'/><polygon fill='#181818' points='418.7642,376.1242,422.7642,386.1242,426.7642,376.1242,422.7642,380.1242' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='438.8124' y2='543.7044'/><polygon fill='#181818' points='418.7642,533.7044,422.7642,543.7044,426.7642,533.7044,422.7642,537.7044' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='596.3926' y2='616.3926'/><polygon fill='#181818' points='418.7642,606.3926,422.7642,616.3926,426.7642,606.3926,422.7642,610.3926' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='955.2644' y2='975.2644'/><polygon fill='#181818' points='418.7642,965.2644,422.7642,975.2644,426.7642,965.2644,422.7642,969.2644' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='1011.6085' y2='1031.6085'/><polygon fill='#181818' points='418.7642,1021.6085,422.7642,1031.6085,426.7642,1021.6085,422.7642,1025.6085' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='716.8038' x2='716.8038' y1='1194.6726' y2='1228.7405'/><polygon fill='#181818' points='712.8038,1218.7405,716.8038,1228.7405,720.8038,1218.7405,716.8038,1222.7405' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='632.9193' x2='557.1869' y1='1300.0665' y2='1300.0665'/><line style='stroke:#181818;stroke-width:1;' x1='557.1869' x2='557.1869' y1='1300.0665' y2='1325.0484'/><polygon fill='#181818' points='553.1869,1315.0484,557.1869,1325.0484,561.1869,1315.0484,557.1869,1319.0484' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='800.6883' x2='876.4208' y1='1300.0665' y2='1300.0665'/><line style='stroke:#181818;stroke-width:1;' x1='876.4208' x2='876.4208' y1='1300.0665' y2='1325.0484'/><polygon fill='#181818' points='872.4208,1315.0484,876.4208,1325.0484,880.4208,1315.0484,876.4208,1319.0484' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='557.1869' x2='557.1869' y1='1410.4249' y2='1428.4249'/><line style='stroke:#181818;stroke-width:1;' x1='557.1869' x2='704.8038' y1='1428.4249' y2='1428.4249'/><polygon fill='#181818' points='694.8038,1424.4249,704.8038,1428.4249,694.8038,1432.4249,698.8038,1428.4249' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='876.4208' x2='876.4208' y1='1394.0807' y2='1428.4249'/><line style='stroke:#181818;stroke-width:1;' x1='876.4208' x2='728.8038' y1='1428.4249' y2='1428.4249'/><polygon fill='#181818' points='738.8038,1424.4249,728.8038,1428.4249,738.8038,1432.4249,734.8038,1428.4249' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='716.8038' x2='716.8038' y1='1265.0846' y2='1285.0846'/><polygon fill='#181818' points='712.8038,1275.0846,716.8038,1285.0846,720.8038,1275.0846,716.8038,1279.0846' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='341.6022' x2='128.7246' y1='1102.9346' y2='1102.9346'/><line style='stroke:#181818;stroke-width:1;' x1='128.7246' x2='128.7246' y1='1102.9346' y2='1127.9164'/><polygon fill='#181818' points='124.7246,1117.9164,128.7246,1127.9164,132.7246,1117.9164,128.7246,1121.9164' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='503.9262' x2='716.8038' y1='1102.9346' y2='1102.9346'/><line style='stroke:#181818;stroke-width:1;' x1='716.8038' x2='716.8038' y1='1102.9346' y2='1141.9844'/><polygon fill='#181818' points='712.8038,1131.9844,716.8038,1141.9844,720.8038,1131.9844,716.8038,1135.9844' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='128.7246' x2='128.7246' y1='1196.9488' y2='1458.4249'/><line style='stroke:#181818;stroke-width:1;' x1='128.7246' x2='410.7642' y1='1458.4249' y2='1458.4249'/><polygon fill='#181818' points='400.7642,1454.4249,410.7642,1458.4249,400.7642,1462.4249,404.7642,1458.4249' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='716.8038' x2='716.8038' y1='1440.4249' y2='1458.4249'/><line style='stroke:#181818;stroke-width:1;' x1='716.8038' x2='434.7642' y1='1458.4249' y2='1458.4249'/><polygon fill='#181818' points='444.7642,1454.4249,434.7642,1458.4249,444.7642,1462.4249,440.7642,1458.4249' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='1067.9527' y2='1087.9527'/><polygon fill='#181818' points='418.7642,1077.9527,422.7642,1087.9527,426.7642,1077.9527,422.7642,1081.9527' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='869.3173' y2='902.5762'/><polygon fill='#181818' points='418.7642,892.5762,422.7642,902.5762,426.7642,892.5762,422.7642,896.5762' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='1470.4249' y2='1480.4249'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='1137.2902' y1='1480.4249' y2='1480.4249'/><polygon fill='#181818' points='1133.2902,1169.5096,1137.2902,1159.5096,1141.2902,1169.5096,1137.2902,1165.5096' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='1137.2902' x2='1137.2902' y1='857.3173' y2='1480.4249'/><line style='stroke:#181818;stroke-width:1;' x1='1137.2902' x2='498.7397' y1='857.3173' y2='857.3173'/><polygon fill='#181818' points='508.7397,853.3173,498.7397,857.3173,508.7397,861.3173,504.7397,857.3173' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='346.7887' x2='27' y1='857.3173' y2='857.3173'/><polygon fill='#181818' points='23,1155.5096,27,1165.5096,31,1155.5096,27,1159.5096' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='27' x2='27' y1='857.3173' y2='1492.4249'/><line style='stroke:#181818;stroke-width:1;' x1='27' x2='422.7642' y1='1492.4249' y2='1492.4249'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='1492.4249' y2='1524.4249'/><polygon fill='#181818' points='418.7642,1514.4249,422.7642,1524.4249,426.7642,1514.4249,422.7642,1518.4249' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='825.3173' y2='845.3173'/><polygon fill='#181818' points='418.7642,835.3173,422.7642,845.3173,426.7642,835.3173,422.7642,839.3173' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='707.217' y2='756.285'/><polygon fill='#181818' points='418.7642,746.285,422.7642,756.285,426.7642,746.285,422.7642,750.285' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='1577.1131' y2='1635.9121'/><polygon fill='#181818' points='418.7642,1625.9121,422.7642,1635.9121,426.7642,1625.9121,422.7642,1629.9121' style='stroke:#181818;stroke-width:1;'/><line style='stroke:#181818;stroke-width:1;' x1='422.7642' x2='422.7642' y1='1672.2562' y2='1741.0552'/><polygon fill='#181818' points='418.7642,1731.0552,422.7642,1741.0552,426.7642,1731.0552,422.7642,1735.0552' style='stroke:#181818;stroke-width:1;'/></g></svg>