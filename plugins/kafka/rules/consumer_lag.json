{
  "high_consumer_lag": {
    "metric_keywords": [
      "consumer_lag",
      "group_lags",
      "lag"
    ],
    "rules": [
      {
        "expression": "data.get('lag', 0) > 10000",
        "level": "critical",
        "score": 9,
        "reasoning": "Consumer group '{data.get('group_id', 'unknown')}' on topic '{data.get('topic', 'unknown')}' has critical lag of {data.get('lag')} messages.",
        "recommendations": [
          "Investigate consumer health and scale if necessary.",
          "Check for processing bottlenecks or errors in consumer logs."
        ]
      },
      {
        "expression": "data.get('lag', 0) > 1000",
        "level": "high",
        "score": 7,
        "reasoning": "Consumer group '{data.get('group_id', 'unknown')}' on topic '{data.get('topic', 'unknown')}' has high lag of {data.get('lag')} messages.",
        "recommendations": [
          "Monitor consumer performance metrics.",
          "Review topic production rates and consumer throughput."
        ]
      }
    ],
    "data_conditions": [
      {
        "key": "group_id",
        "exists": true
      },
      {
        "key": "lag",
        "exists": true
      },
      {
        "key": "topic",
        "exists": true
      }
    ]
  }
}
