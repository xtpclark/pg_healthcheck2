{
  "critical_data_loss_unclean": {
    "metric_keywords": ["prometheus_unclean_elections", "per_broker_unclean", "data"],
    "data_conditions": [{"key": "unclean_elections", "exists": true}],
    "rules": [{
      "expression": "data.get('unclean_elections', 0) > 0",
      "level": "critical",
      "score": 10,
      "reasoning": "ðŸš¨ DATA LOSS: Broker {data.get('node_id', 'unknown')[:8]} had {data.get('unclean_elections')} unclean leader election(s) - PERMANENT DATA LOSS occurred",
      "recommendations": [
        "DATA LOSS EVENT - notify stakeholders immediately",
        "Identify affected topics/partitions in logs",
        "Review why all ISR replicas were unavailable",
        "Set unclean.leader.election.enable=false",
        "Ensure RFâ‰¥3 and min.insync.replicas=2"
      ]
    }]
  },
  "healthy_no_data_loss": {
    "metric_keywords": ["prometheus_unclean_elections", "cluster_aggregate"],
    "rules": [{
      "expression": "data.get('total_unclean_elections', 0) == 0",
      "level": "info",
      "score": 0,
      "reasoning": "No unclean elections - no data loss events detected",
      "recommendations": ["Maintain current configuration", "Ensure unclean.leader.election.enable=false"]
    }]
  }
}
